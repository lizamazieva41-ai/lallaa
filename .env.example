# Payment Sandbox API Environment Configuration
# Copy this file to .env and update values for your environment
#
# Environment Variables Usage:
# - API Variables: Used by the main API application
# - ETL Variables: Used only by data processing scripts  
# - Shared Variables: Used by both API and ETL

# ========== API APPLICATION VARIABLES ==========

# Application
NODE_ENV=development
API_PORT=8080
API_HOST=0.0.0.0
FRONTEND_URL=http://localhost:3000

# Database Configuration
DB_HOST=localhost
DB_PORT=5432
POSTGRES_USER=bincheck
POSTGRES_PASSWORD=your_secure_password_here
POSTGRES_DB=bincheck
DB_SSL=false
DB_POOL_MIN=2
DB_POOL_MAX=10

# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=bincheck:

# JWT Configuration
# Generate secure secrets using: openssl rand -base64 32
JWT_SECRET=your_jwt_secret_key_change_in_production
JWT_REFRESH_SECRET=your_refresh_secret_key_change_in_production
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# Security Configuration
BCRYPT_ROUNDS=12
SALT_ROUNDS=10
API_KEY_PREFIX=bincheck
API_KEY_BYTES=32

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_FAIL_POLICY=open  # 'open' (allow) or 'closed' (block) when Redis is down
RATE_LIMIT_MAX_FREE=100
RATE_LIMIT_MAX_BASIC=500
RATE_LIMIT_MAX_PREMIUM=2000
RATE_LIMIT_MAX_ENTERPRISE=10000

# Logging
LOG_LEVEL=info
LOG_FILE_PATH=./logs
LOG_MAX_FILES=5
LOG_MAX_SIZE=20m

# CORS
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# ========== ETL SCRIPTS VARIABLES ==========

# ETL Configuration (used only by scripts/etl/ and scripts/backup/)
# ADMIN_SECRET is used for ETL authentication and data source validation
ADMIN_SECRET=your_admin_secret_change_in_production

# ETL Data Sources (optional - will use defaults if not specified)
BIN_DATA_SOURCES_PRIORITY=binlist/data,venelinkochev/bin-list-data,aderyabin/bin_list
BIN_DATA_CACHE_TTL=3600

# ETL Output Configuration
ETL_OUTPUT_DIR=./data/processed
ETL_BACKUP_DIR=./data/backup
ETL_LOG_LEVEL=info

# ========== SHARED VARIABLES ==========

# Email Configuration (for password reset - used by API and ETL notifications)
# Configure your email service provider settings here
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASSWORD=your_app_password
EMAIL_FROM=noreply@yourdomain.com
EMAIL_FROM_NAME=Payment Sandbox API

# Feature Flags (used by API)
# Production card generation requires FEATURE_CARD_GENERATION_PRODUCTION_UNLOCK=true
FEATURE_CARD_GENERATION=false
FEATURE_TEST_CARDS_ACCESS=true
FEATURE_ADMIN_PANEL=true

# Development/Testing
# Set to true to expose more detailed error messages in development
DEBUG_MODE=false

# Production Feature Unlock
# Set to true to enable card generation in production (DANGEROUS - use with caution)
FEATURE_CARD_GENERATION_PRODUCTION_UNLOCK=false

# Monitoring
# Optional: External monitoring service endpoints
HEALTH_CHECK_EXTERNAL_URL=
METRICS_EXTERNAL_ENDPOINT=

# ========== NOTES ==========

# API Production Deployment:
# Use: npm run deploy (builds, migrates, seeds, starts PM2)
#
# ETL Script Execution:
# Use: npm run etl (uses BIN_DATA_SOURCES_* and ADMIN_SECRET)
#
# Environment File Separation (Optional):
# For production, you can create separate files:
# - .env.api (for API deployment)
# - .env.etl (for ETL scripts)